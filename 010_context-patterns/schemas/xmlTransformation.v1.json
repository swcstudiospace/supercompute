{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://supercompute.me/schemas/xml-transformation/v1.0.0",
  "title": "XML Transformation Schema v1.0",
  "description": "Schema for XML-wrapped data transformations in Context Patterns",
  "type": "object",
  "version": "1.0.0",
  
  "properties": {
    "xmlTransformation": {
      "type": "object",
      "description": "XML transformation configuration",
      "required": ["version", "schema", "operations"],
      
      "properties": {
        "version": {
          "type": "string",
          "const": "1.0.0",
          "description": "XML transformation schema version"
        },
        
        "schema": {
          "type": "object",
          "description": "XML schema configuration",
          "required": ["namespace", "validation"],
          
          "properties": {
            "namespace": {
              "type": "string",
              "const": "https://supercompute.ai/xml/context-patterns",
              "description": "XML namespace for context patterns"
            },
            "validation": {
              "type": "string",
              "enum": ["strict", "lenient", "custom"],
              "description": "XML validation mode"
            },
            "encoding": {
              "type": "string",
              "const": "UTF-8",
              "description": "XML encoding"
            }
          }
        },
        
        "operations": {
          "type": "array",
          "description": "XML transformation operations",
          "items": {
            "type": "object",
            "required": ["id", "type", "xml_tag", "parameters"],
            
            "properties": {
              "id": {
                "type": "string",
                "description": "Operation identifier"
              },
              "type": {
                "type": "string",
                "enum": ["wrap", "unwrap", "transform", "validate", "extract"],
                "description": "Operation type"
              },
              "xml_tag": {
                "type": "string",
                "pattern": "^<xml:[a-zA-Z_]+>$",
                "description": "XML tag to use"
              },
              "parameters": {
                "type": "object",
                "description": "Operation-specific parameters",
                "properties": {
                  "attributes": {
                    "type": "object",
                    "description": "XML attributes",
                    "patternProperties": {
                      "^[a-zA-Z_]+$": {
                        "type": "string"
                      }
                    }
                  },
                  "content_type": {
                    "type": "string",
                    "enum": ["text", "json", "xml", "binary"],
                    "description": "Content type"
                  },
                  "encoding": {
                    "type": "string",
                    "description": "Content encoding"
                  },
                  "validation_rules": {
                    "type": "array",
                    "description": "Validation rules",
                    "items": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": ["regex", "length", "format", "custom"]
                        },
                        "rule": {
                          "type": "string",
                          "description": "Validation rule"
                        },
                        "message": {
                          "type": "string",
                          "description": "Validation message"
                        }
                      }
                    }
                  }
                }
              },
              
              "dependencies": {
                "type": "array",
                "description": "Operation dependencies",
                "items": {
                  "type": "string"
                }
              },
              
              "error_handling": {
                "type": "object",
                "description": "Error handling configuration",
                "properties": {
                  "strategy": {
                    "type": "string",
                    "enum": ["fail", "skip", "retry", "fallback"],
                    "description": "Error handling strategy"
                  },
                  "retry_count": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 10,
                    "description": "Number of retries"
                  },
                  "fallback_operation": {
                    "type": "string",
                    "description": "Fallback operation ID"
                  }
                }
              }
            }
          }
        },
        
        "pipeline": {
          "type": "object",
          "description": "Transformation pipeline configuration",
          "required": ["steps"],
          
          "properties": {
            "steps": {
              "type": "array",
              "description": "Pipeline steps",
              "items": {
                "type": "object",
                "required": ["operation_id", "order"],
                
                "properties": {
                  "operation_id": {
                    "type": "string",
                    "description": "Operation ID to execute"
                  },
                  "order": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Step order"
                  },
                  "parallel": {
                    "type": "boolean",
                    "description": "Whether to run in parallel"
                  },
                  "condition": {
                    "type": "string",
                    "description": "Execution condition"
                  }
                }
              }
            },
            
            "execution_mode": {
              "type": "string",
              "enum": ["sequential", "parallel", "quantum"],
              "description": "Pipeline execution mode"
            },
            
            "error_handling": {
              "type": "string",
              "enum": ["stop_on_error", "continue_on_error", "retry_on_error"],
              "description": "Pipeline error handling"
            }
          }
        },
        
        "validation": {
          "type": "object",
          "description": "Validation configuration",
          "properties": {
            "strict_mode": {
              "type": "boolean",
              "description": "Whether to use strict validation"
            },
            "custom_validators": {
              "type": "array",
              "description": "Custom validator functions",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Validator name"
                  },
                  "function": {
                    "type": "string",
                    "description": "Validator function"
                  },
                  "parameters": {
                    "type": "object",
                    "description": "Validator parameters"
                  }
                }
              }
            },
            "output_schema": {
              "type": "string",
              "description": "Output schema reference"
            }
          }
        }
      }
    }
  },
  
  "required": ["xmlTransformation"],
  
  "additionalProperties": false,
  
  "examples": [
    {
      "xmlTransformation": {
        "version": "1.0.0",
        "schema": {
          "namespace": "https://supercompute.ai/xml/context-patterns",
          "validation": "strict",
          "encoding": "UTF-8"
        },
        "operations": [
          {
            "id": "context_wrap",
            "type": "wrap",
            "xml_tag": "<xml:context>",
            "parameters": {
              "attributes": {
                "type": "semantic",
                "confidence": "0.95"
              },
              "content_type": "text"
            }
          },
          {
            "id": "pattern_extract",
            "type": "extract",
            "xml_tag": "<xml:pattern>",
            "parameters": {
              "attributes": {
                "id": "auto",
                "category": "semantic"
              },
              "validation_rules": [
                {
                  "type": "regex",
                  "rule": "^[a-zA-Z0-9_]+$",
                  "message": "Pattern ID must be alphanumeric"
                }
              ]
            }
          }
        ],
        "pipeline": {
          "steps": [
            {
              "operation_id": "context_wrap",
              "order": 0,
              "parallel": false
            },
            {
              "operation_id": "pattern_extract",
              "order": 1,
              "parallel": false,
              "condition": "context_available"
            }
          ],
          "execution_mode": "sequential",
          "error_handling": "stop_on_error"
        },
        "validation": {
          "strict_mode": true,
          "output_schema": "contextPattern.v1.json"
        }
      }
    }
  ]
}